<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>棚卸し管理アプリ</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#21808D">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="棚卸し管理">
</head>
<body>
    <!-- メインメニュー画面 -->
    <div id="main-menu" class="screen active">
        <div class="container">
            <h1 class="app-title">棚卸し管理</h1>
            <div class="menu-buttons">
                <button class="btn btn--primary btn--menu" data-screen="inventory">
                    📦 棚卸し
                </button>
                <button class="btn btn--secondary btn--menu" data-screen="import">
                    📂 データ取り込み
                </button>
                <button class="btn btn--secondary btn--menu" data-screen="export">
                    📤 データ出力
                </button>
                <button class="btn btn--secondary btn--menu" data-screen="edit">
                    ✏️ 編集
                </button>
                <button class="btn btn--secondary btn--menu" data-screen="settings">
                    ⚙️ 設定
                </button>
            </div>
        </div>
    </div>

    <!-- 棚卸し画面 -->
    <div id="inventory" class="screen">
        <div class="container">
            <h2 class="screen-title">棚卸し入力</h2>
            
            <div class="form-group">
                <button id="qr-scan-btn" class="btn btn--primary btn--full-width btn--action">
                    📷 QRコード読み取り
                </button>
            </div>

            <div id="qr-reader" class="hidden">
                <div id="qr-reader-controls" class="qr-controls">
                    <button id="light-toggle" class="btn btn--secondary">💡 ライト</button>
                    <button id="stop-scan" class="btn btn--outline">停止</button>
                </div>
                <div id="qr-reader-element"></div>
            </div>

            <div class="form-group">
                <label class="form-label">商品コード</label>
                <input type="text" id="product-code" class="form-control" placeholder="手入力またはQRスキャン">
            </div>

            <div class="form-group">
                <label class="form-label">商品名</label>
                <input type="text" id="product-name" class="form-control" placeholder="商品名（自動表示）">
            </div>

            <div class="form-group">
                <label class="form-label">数量</label>
                <input type="number" id="quantity" class="form-control" value="1" min="1">
            </div>

            <div class="form-group">
                <label class="form-label">単位</label>
                <select id="unit" class="form-control">
                    <option value="個">個</option>
                    <option value="箱">箱</option>
                    <option value="甲">甲</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">ロット</label>
                <input type="text" id="lot" class="form-control" placeholder="ロット番号">
            </div>

            <div class="form-group">
                <label class="form-label">棚番号</label>
                <input type="text" id="shelf" class="form-control" placeholder="棚番号">
            </div>

            <div class="button-group">
                <button id="register-btn" class="btn btn--primary btn--action">
                    ✅ 登録
                </button>
                <button class="btn btn--outline back-btn" data-screen="main-menu">
                    ← メニューに戻る
                </button>
            </div>
        </div>
    </div>

    <!-- データ取り込み画面 -->
    <div id="import" class="screen">
        <div class="container">
            <h2 class="screen-title">データ取り込み</h2>
            
            <div class="form-group">
                <label class="form-label">商品マスタ（.xlsx）</label>
                <input type="file" id="product-file" class="form-control" accept=".xlsx">
                <button id="import-products" class="btn btn--secondary btn--full-width mt-8">
                    商品マスタ取り込み
                </button>
            </div>

            <div class="form-group">
                <label class="form-label">データ在庫（.xls/.xlsx）</label>
                <input type="file" id="stock-file" class="form-control" accept=".xls,.xlsx">
                <button id="import-stock" class="btn btn--secondary btn--full-width mt-8">
                    在庫データ取り込み
                </button>
            </div>

            <div id="import-status" class="status status--info hidden">
                取り込み中...
            </div>

            <div class="button-group">
                <button class="btn btn--outline back-btn" data-screen="main-menu">
                    ← メニューに戻る
                </button>
            </div>
        </div>
    </div>

    <!-- データ出力画面 -->
    <div id="export" class="screen">
        <div class="container">
            <h2 class="screen-title">データ出力</h2>
            
            <div class="form-group">
                <label class="form-label">出力形式</label>
                <select id="export-format" class="form-control">
                    <option value="csv">CSV形式</option>
                    <option value="xlsx">Excel形式</option>
                </select>
            </div>

            <div class="form-group">
                <button id="download-btn" class="btn btn--primary btn--full-width btn--action">
                    📥 ダウンロード
                </button>
            </div>

            <div class="button-group">
                <button class="btn btn--outline back-btn" data-screen="main-menu">
                    ← メニューに戻る
                </button>
            </div>
        </div>
    </div>

    <!-- 編集画面 -->
    <div id="edit" class="screen">
        <div class="container">
            <h2 class="screen-title">データ編集</h2>
            
            <div class="edit-controls">
                <button id="delete-all-btn" class="btn btn--outline" style="color: var(--color-error); border-color: var(--color-error);">
                    🗑️ 一括削除
                </button>
            </div>

            <div id="data-list" class="data-list">
                <!-- データ一覧がここに表示される -->
            </div>

            <div class="button-group">
                <button class="btn btn--outline back-btn" data-screen="main-menu">
                    ← メニューに戻る
                </button>
            </div>
        </div>
    </div>

    <!-- 設定画面 -->
    <div id="settings" class="screen">
        <div class="container">
            <h2 class="screen-title">設定</h2>
            
            <div class="form-group">
                <label class="form-label">担当者名</label>
                <input type="text" id="user-name" class="form-control" placeholder="担当者名">
            </div>

            <div class="form-group">
                <label class="form-label">センター名</label>
                <select id="center-select" class="form-control">
                    <option value="">選択してください</option>
                </select>
                <input type="text" id="center-manual" class="form-control mt-8" placeholder="手動入力">
            </div>

            <div class="form-group">
                <label class="form-label">コード種類</label>
                <select id="code-type" class="form-control">
                    <option value="QR">QRコード</option>
                    <option value="JAN">JANコード</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">出力形式</label>
                <select id="output-format" class="form-control">
                    <option value="csv">CSV</option>
                    <option value="xlsx">Excel</option>
                </select>
            </div>

            <div class="button-group">
                <button id="save-settings" class="btn btn--primary btn--action">
                    💾 設定保存
                </button>
                <button id="clear-all-data" class="btn btn--outline" style="color: var(--color-error); border-color: var(--color-error);">
                    🗑️ データオールクリア
                </button>
                <button class="btn btn--outline back-btn" data-screen="main-menu">
                    ← メニューに戻る
                </button>
            </div>
        </div>
    </div>

    <!-- 編集モーダル -->
    <div id="edit-modal" class="modal hidden">
        <div class="modal-content">
            <h3>データ編集</h3>
            <div class="form-group">
                <label class="form-label">商品コード</label>
                <input type="text" id="edit-code" class="form-control" readonly>
            </div>
            <div class="form-group">
                <label class="form-label">商品名</label>
                <input type="text" id="edit-name" class="form-control">
            </div>
            <div class="form-group">
                <label class="form-label">数量</label>
                <input type="number" id="edit-quantity" class="form-control" min="1">
            </div>
            <div class="form-group">
                <label class="form-label">単位</label>
                <select id="edit-unit" class="form-control">
                    <option value="個">個</option>
                    <option value="箱">箱</option>
                    <option value="甲">甲</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">ロット</label>
                <input type="text" id="edit-lot" class="form-control">
            </div>
            <div class="form-group">
                <label class="form-label">棚番号</label>
                <input type="text" id="edit-shelf" class="form-control">
            </div>
            <div class="modal-buttons">
                <button id="save-edit" class="btn btn--primary">保存</button>
                <button id="delete-item" class="btn btn--outline" style="color: var(--color-error); border-color: var(--color-error);">削除</button>
                <button id="cancel-edit" class="btn btn--outline">キャンセル</button>
            </div>
        </div>
    </div>

    <script src="https://seiumiyata.github.io/invent2/html5-qrcode.min.js"></script>
    <script src="https://seiumiyata.github.io/invent2/xlsx.full.min.js"></script>
    <script src="app.js"></script>
</body>
</html>